<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
  <head>
    <meta content="text/html; charset=windows-1252"
      http-equiv="Content-Type">
    <title>Advice #30005</title>
  </head>
  <body>
    <table style="float: right; background: #F9F9F9;" border="5"
      cellpadding="10" cellspacing="0">
      <tbody>
        <tr>
          <td>
            <h2> <span class="mw-headline"
                id="Advice_Advisor_-_Rule_Table"> <a
href="http://processors.wiki.ti.com/index.php/Compiler/diagnostic_messages/C6000"
                  title="Advice Advisor"><span style="color:#1F2BB8;">
                    Compiler Advice (on TI Wiki)</span></a> </span></h2>
            <p> <a
href="http://processors.wiki.ti.com/index.php/Compiler/diagnostic_messages/C6000/27000"
                title="Compiler/diagnostic messages/C6000/27000"><span
                  style="color:#1F2BB8;"> Advice 27000: Use Optimization
                  Options</span></a><br>
              <a
href="http://processors.wiki.ti.com/index.php/Compiler/diagnostic_messages/C6000/27001"
                title="Compiler/diagnostic messages/C6000/27001"><span
                  style="color:#1F2BB8;"> Advice 27001: Increase
                  Optimization Level</span></a><br>
              <a
href="http://processors.wiki.ti.com/index.php/Compiler/diagnostic_messages/C6000/27002"
                title="Compiler/diagnostic messages/C6000/27002"><span
                  style="color:#1F2BB8;"> Advice 27002: Do not turn off
                  software pipelining</span></a><br>
              <a
href="http://processors.wiki.ti.com/index.php/Compiler/diagnostic_messages/C6000/27003"
                title="Compiler/diagnostic messages/C6000/27003"><span
                  style="color:#1F2BB8;"> Advice 27003: Avoid compiling
                  with debug options</span></a><br>
              <a
href="http://processors.wiki.ti.com/index.php/Compiler/diagnostic_messages/C6000/27004"
                title="Compiler/diagnostic messages/C6000/27004"><span
                  style="color:#1F2BB8;"> Advice 27004: No Performance
                  Advice generated</span></a><br>
              <a
href="http://processors.wiki.ti.com/index.php/Compiler/diagnostic_messages/C6000/30000"
                title="Compiler/diagnostic messages/C6000/30002"><span
                  style="color:#1F2BB8;"> Advice 30000: Prevent Loop
                  Disqualification due to call</span></a><br>
              <a
href="http://processors.wiki.ti.com/index.php/Compiler/diagnostic_messages/C6000/30001"
                title="Compiler/diagnostic messages/C6000/30002"><span
                  style="color:#1F2BB8;"> Advice 30001: Prevent Loop
                  Disqualification due to rts-call</span></a><br>
              <a
href="http://processors.wiki.ti.com/index.php/Compiler/diagnostic_messages/C6000/30002"
                title="Compiler/diagnostic messages/C6000/30002"><span
                  style="color:#1F2BB8;"> Advice 30002: Prevent Loop
                  Disqualification due to asm statement</span></a><br>
              <a
href="http://processors.wiki.ti.com/index.php/Compiler/diagnostic_messages/C6000/30003"
                title="Compiler/diagnostic messages/C6000/30003"><span
                  style="color:#1F2BB8;"> Advice 30003: Prevent Loop
                  Disqualification due to complex condition</span></a><br>
              <a
href="http://processors.wiki.ti.com/index.php/Compiler/diagnostic_messages/C6000/30004"
                title="Compiler/diagnostic messages/C6000/30004"><span
                  style="color:#1F2BB8;"> Advice 30004: Prevent Loop
                  Disqualification due to switch statement</span></a><br>
              <a
href="http://processors.wiki.ti.com/index.php/Compiler/diagnostic_messages/C6000/30005"
                title="Compiler/diagnostic messages/C6000/30005"><span
                  style="color:#1F2BB8;"> Advice 30005: Prevent Loop
                  Disqualification due to arithmetic operation</span></a><br>
              <a
href="http://processors.wiki.ti.com/index.php/Compiler/diagnostic_messages/C6000/30006"
                title="Compiler/diagnostic messages/C6000/30006"><span
                  style="color:#1F2BB8;"> Advice 30006: Prevent Loop
                  Disqualification due to call(2)</span></a><br>
              <a
href="http://processors.wiki.ti.com/index.php/Compiler/diagnostic_messages/C6000/30007"
                title="Compiler/diagnostic messages/C6000/30007"><span
                  style="color:#1F2BB8;"> Advice 30007: Prevent Loop
                  Disqualification due to rts-call(2)</span></a><br>
              <a
href="http://processors.wiki.ti.com/index.php/Compiler/diagnostic_messages/C6000/30008"
                title="Compiler/diagnostic messages/C6000/30008"><span
                  style="color:#1F2BB8;"> Advice 30008: Improve Loop;
                  Qualify with restrict</span></a><br>
              <a
href="http://processors.wiki.ti.com/index.php/Compiler/diagnostic_messages/C6000/30009"
                title="Compiler/diagnostic messages/C6000/30009"><span
                  style="color:#1F2BB8;"> Advice 30009: Improve Loop;
                  Add MUST_ITERATE pragma</span></a><br>
              <a
href="http://processors.wiki.ti.com/index.php/Compiler/diagnostic_messages/C6000/30010"
                title="Compiler/diagnostic messages/C6000/30010"><span
                  style="color:#1F2BB8;"> Advice 30010: Improve Loop;
                  Add MUST_ITERATE pragma(2)</span></a><br>
              <a
href="http://processors.wiki.ti.com/index.php/Compiler/diagnostic_messages/C6000/30011"
                title="Compiler/diagnostic messages/C6000/30011"><span
                  style="color:#1F2BB8;"> Advice 30011: Improve Loop;
                  Add _nassert()</span></a><br>
            </p>
          </td>
        </tr>
      </tbody>
    </table>
    <h2><span id="Typical_Advice" class="mw-headline">Typical Advice </span></h2>
    <pre> advice #30005: Loop at line 5 cannot be scheduled efficiently, as it
contains a "division" operation. Rewrite using simpler
operations if possible.

</pre>
    <h2><span id="Why_is_the_Compiler_giving_this_Advice_.3F"
        class="mw-headline">Why is the Compiler giving this
        Advice&nbsp;? </span></h2>
    <p>The compiler is inserting a special function call within a loop,
      which prevents the software pipelining optimization. Software
      pipelining is a key compiler optimization for achieving good
      performance. You are getting this Advice so you can take steps to
      potentially prevent this pipeline disqualification. </p>
    <p><br>
    </p>
    <h2><span id="What_it_means:" class="mw-headline">What it means: </span></h2>
    <p>The compiler can insert calls to special functions in the
      run-time support library (RTS) to support operations that are not
      natively supported by the ISA. For example, the compiler calls
      __c6xabi_divi() (_divi() in COFF) function to perform 32-bit
      integer divide operation. Such functions are called compiler
      helper functions, and result in a function call withing the loop
      body. In the example below, the compiler will accomplish the
      division operation by calling the compiler helper function
      "_divi"&nbsp;: </p>
    <div class="csh">
      <pre style="FONT-FAMILY: monospace" class="c"><span style="COLOR: #993333">void</span> func<span style="COLOR: #009900">(</span><span style="COLOR: #993333">float</span> <span style="COLOR: #339933">*</span>p<span style="COLOR: #339933">,</span> <span style="COLOR: #993333">float</span> n<span style="COLOR: #009900">)</span>
<span style="COLOR: #009900">{</span>
<span style="COLOR: #993333">     int</span> i<span style="COLOR: #339933">;</span>
&nbsp;
<span style="COLOR: #b1b100">     for</span> <span style="COLOR: #009900">(</span>i <span style="COLOR: #339933">=</span> <span style="COLOR: #0000dd">1</span><span style="COLOR: #339933">;</span> i <span style="COLOR: #339933">&lt;</span> <span style="COLOR: #0000dd">1000</span><span style="COLOR: #339933">;</span> i<span style="COLOR: #339933">++</span><span style="COLOR: #009900">)</span>
<span style="COLOR: #009900">     {</span>
         p<span style="COLOR: #009900">[</span>i<span style="COLOR: #009900">]</span> <span style="COLOR: #339933">/=</span> n<span style="COLOR: #339933">;</span>
<span style="COLOR: #009900">     }</span>
<span style="COLOR: #009900">}</span></pre>
    </div>
    <p>However if we modify this loop, like below, the loop
      pipelines&nbsp;: </p>
    <div class="csh">
      <pre style="FONT-FAMILY: monospace" class="c"><span style="COLOR: #993333">void</span> func_adjusted<span style="COLOR: #009900">(</span><span style="COLOR: #993333">float</span> <span style="COLOR: #339933">*</span>p<span style="COLOR: #339933">,</span> <span style="COLOR: #993333">float</span> n<span style="COLOR: #009900">)</span>
<span style="COLOR: #009900">{</span>
<span style="COLOR: #993333">     int</span> i<span style="COLOR: #339933">;</span>
&nbsp;
<span style="COLOR: #993333">     float</span> inv <span style="COLOR: #339933">=</span> 1<span style="COLOR: #339933">/</span>n<span style="COLOR: #339933">;</span>
&nbsp;
<span style="COLOR: #b1b100">     for</span> <span style="COLOR: #009900">(</span>i <span style="COLOR: #339933">=</span> <span style="COLOR: #0000dd">1</span><span style="COLOR: #339933">;</span> i <span style="COLOR: #339933">&lt;</span> <span style="COLOR: #0000dd">1000</span><span style="COLOR: #339933">;</span> i<span style="COLOR: #339933">++</span><span style="COLOR: #009900">)</span>
<span style="COLOR: #009900">     {</span>
         p<span style="COLOR: #009900">[</span>i<span style="COLOR: #009900">]</span> <span style="COLOR: #339933">*=</span> inv<span style="COLOR: #339933">;</span>
<span style="COLOR: #009900">     }</span>
<span style="COLOR: #009900">}</span></pre>
    </div>
    <p>Any call in a loop, including calls to compiler helper functions,
      disables software pipelining, and this may result in a drop in
      performance. </p>
    <p><br>
    </p>
    <h2><span id="Risks.2C_Severity" class="mw-headline">Risks, Severity
      </span></h2>
    <p>If this condition occurs, the compiler cannot perform the
      software pipelining loop optimization, which is crucial to getting
      good performance. </p>
    <p><br>
    </p>
    <h2><span id="Suggested_Action" class="mw-headline">Suggested Action
      </span></h2>
    <p>Rewrite code using simpler operation(s). </p>
    <h2> <span class="mw-headline" id="More_Resources"> More Resources
      </span></h2>
    <p>Want to squeeze a few more Performance Cycles out of your
      application? Leverage the e2e (Engineer-to-Engineer) online
      community to get all of your Advice questions answered! Or, give
      back to the community with your expertise. </p>
    <p><a
        href="http://e2e.ti.com/support/development_tools/compiler/default.aspx"
        class="external text" rel="nofollow">Go to the TI Compiler's e2e
        online forum!</a>&nbsp; </p>
    <div class="hf-nsfooter">
      <table class="wikitable" style="text-align:center;
        background:White;">
        <tbody>
          <tr>
            <td><a
                href="http://processors.wiki.ti.com/index.php/File:E2e.jpg"
                class="image"><img alt="E2e.jpg"
                  src="http://processors.wiki.ti.com/images/8/82/E2e.jpg"
                  height="63" width="305"></a> </td>
            <td><i>For technical support please post your questions at <a
                  href="http://e2e.ti.com/" class="external free"
                  rel="nofollow">http://e2e.ti.com</a>. </i> </td>
          </tr>
        </tbody>
      </table>
    </div>
  </body>
</html>
