<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
  <head>
    <meta content="text/html; charset=windows-1252"
      http-equiv="Content-Type">
    <title>Advice #30003</title>
  </head>
  <body>
    <table style="float: right; background: #F9F9F9;" border="5"
      cellpadding="10" cellspacing="0">
      <tbody>
        <tr>
          <td>
            <h2> <span class="mw-headline"
                id="Advice_Advisor_-_Rule_Table"> <a
href="http://processors.wiki.ti.com/index.php/Compiler/diagnostic_messages/C6000"
                  title="Advice Advisor"><span style="color:#1F2BB8;">
                    Compiler Advice (on TI Wiki)</span></a> </span></h2>
            <p> <a
href="http://processors.wiki.ti.com/index.php/Compiler/diagnostic_messages/C6000/27000"
                title="Compiler/diagnostic messages/C6000/27000"><span
                  style="color:#1F2BB8;"> Advice 27000: Use Optimization
                  Options</span></a><br>
              <a
href="http://processors.wiki.ti.com/index.php/Compiler/diagnostic_messages/C6000/27001"
                title="Compiler/diagnostic messages/C6000/27001"><span
                  style="color:#1F2BB8;"> Advice 27001: Increase
                  Optimization Level</span></a><br>
              <a
href="http://processors.wiki.ti.com/index.php/Compiler/diagnostic_messages/C6000/27002"
                title="Compiler/diagnostic messages/C6000/27002"><span
                  style="color:#1F2BB8;"> Advice 27002: Do not turn off
                  software pipelining</span></a><br>
              <a
href="http://processors.wiki.ti.com/index.php/Compiler/diagnostic_messages/C6000/27003"
                title="Compiler/diagnostic messages/C6000/27003"><span
                  style="color:#1F2BB8;"> Advice 27003: Avoid compiling
                  with debug options</span></a><br>
              <a
href="http://processors.wiki.ti.com/index.php/Compiler/diagnostic_messages/C6000/27004"
                title="Compiler/diagnostic messages/C6000/27004"><span
                  style="color:#1F2BB8;"> Advice 27004: No Performance
                  Advice generated</span></a><br>
              <a
href="http://processors.wiki.ti.com/index.php/Compiler/diagnostic_messages/C6000/30000"
                title="Compiler/diagnostic messages/C6000/30002"><span
                  style="color:#1F2BB8;"> Advice 30000: Prevent Loop
                  Disqualification due to call</span></a><br>
              <a
href="http://processors.wiki.ti.com/index.php/Compiler/diagnostic_messages/C6000/30001"
                title="Compiler/diagnostic messages/C6000/30002"><span
                  style="color:#1F2BB8;"> Advice 30001: Prevent Loop
                  Disqualification due to rts-call</span></a><br>
              <a
href="http://processors.wiki.ti.com/index.php/Compiler/diagnostic_messages/C6000/30002"
                title="Compiler/diagnostic messages/C6000/30002"><span
                  style="color:#1F2BB8;"> Advice 30002: Prevent Loop
                  Disqualification due to asm statement</span></a><br>
              <a
href="http://processors.wiki.ti.com/index.php/Compiler/diagnostic_messages/C6000/30003"
                title="Compiler/diagnostic messages/C6000/30003"><span
                  style="color:#1F2BB8;"> Advice 30003: Prevent Loop
                  Disqualification due to complex condition</span></a><br>
              <a
href="http://processors.wiki.ti.com/index.php/Compiler/diagnostic_messages/C6000/30004"
                title="Compiler/diagnostic messages/C6000/30004"><span
                  style="color:#1F2BB8;"> Advice 30004: Prevent Loop
                  Disqualification due to switch statement</span></a><br>
              <a
href="http://processors.wiki.ti.com/index.php/Compiler/diagnostic_messages/C6000/30005"
                title="Compiler/diagnostic messages/C6000/30005"><span
                  style="color:#1F2BB8;"> Advice 30005: Prevent Loop
                  Disqualification due to arithmetic operation</span></a><br>
              <a
href="http://processors.wiki.ti.com/index.php/Compiler/diagnostic_messages/C6000/30006"
                title="Compiler/diagnostic messages/C6000/30006"><span
                  style="color:#1F2BB8;"> Advice 30006: Prevent Loop
                  Disqualification due to call(2)</span></a><br>
              <a
href="http://processors.wiki.ti.com/index.php/Compiler/diagnostic_messages/C6000/30007"
                title="Compiler/diagnostic messages/C6000/30007"><span
                  style="color:#1F2BB8;"> Advice 30007: Prevent Loop
                  Disqualification due to rts-call(2)</span></a><br>
              <a
href="http://processors.wiki.ti.com/index.php/Compiler/diagnostic_messages/C6000/30008"
                title="Compiler/diagnostic messages/C6000/30008"><span
                  style="color:#1F2BB8;"> Advice 30008: Improve Loop;
                  Qualify with restrict</span></a><br>
              <a
href="http://processors.wiki.ti.com/index.php/Compiler/diagnostic_messages/C6000/30009"
                title="Compiler/diagnostic messages/C6000/30009"><span
                  style="color:#1F2BB8;"> Advice 30009: Improve Loop;
                  Add MUST_ITERATE pragma</span></a><br>
              <a
href="http://processors.wiki.ti.com/index.php/Compiler/diagnostic_messages/C6000/30010"
                title="Compiler/diagnostic messages/C6000/30010"><span
                  style="color:#1F2BB8;"> Advice 30010: Improve Loop;
                  Add MUST_ITERATE pragma(2)</span></a><br>
              <a
href="http://processors.wiki.ti.com/index.php/Compiler/diagnostic_messages/C6000/30011"
                title="Compiler/diagnostic messages/C6000/30011"><span
                  style="color:#1F2BB8;"> Advice 30011: Improve Loop;
                  Add _nassert()</span></a><br>
            </p>
          </td>
        </tr>
      </tbody>
    </table>
    <h2><span id="Typical_Advice" class="mw-headline">Typical Advice </span></h2>
    <pre> advice #30003: Loop at line 8 cannot be scheduled efficiently, as it
contains complex conditional expression. Try to simplify
condition.

</pre>
    <h2><span id="Why_is_the_Compiler_giving_this_Advice.3F"
        class="mw-headline">Why is the Compiler giving this Advice? </span></h2>
    <p>This Advice is issued to alert you to a complex conditional
      expression, generally a large "if" clause, within a loop. This
      will disable software-pipelining, which is critical for generating
      efficient code sequences. </p>
    <p><br>
    </p>
    <h2><span id="What_it_means:" class="mw-headline">What it means: </span></h2>
    <p>The C6000 compiler will optimize small if statements (if
      statements with if and else blocks that are short or empty).
      The compiler will not optimize large "if" statements, and such
      large if statements within the loop body will disqualify the loop
      for software pipelining. Software-pipelining is a key
      optimization; you will see reduced performance without software
      pipelining. In the simple examples below, Example 1 will pipeline,
      but Example 2 won't&nbsp;: </p>
    <p>Example 1: </p>
    <div class="mw-geshi mw-code mw-content-ltr" dir="ltr">
      <div class="c source-c">
        <pre class="de1"><span class="kw1">for</span> <span class="br0">(</span>i<span class="sy0">=</span><span class="nu0">0</span><span class="sy0">;</span> i <span class="sy0">&lt;</span> N<span class="sy0">;</span> i<span class="sy0">++</span><span class="br0">)</span>
<span class="br0">{</span>
        <span class="kw1">if</span> <span class="br0">(</span><span class="sy0">!</span>flag<span class="br0">)</span>
        <span class="br0">{</span>
           <span class="co1">//statements</span>
        <span class="br0">}</span>
        <span class="kw1">else</span>
        <span class="br0">{</span>
          x<span class="br0">[</span>i<span class="br0">]</span> <span class="sy0">=</span> y<span class="br0">[</span>i<span class="br0">]</span><span class="sy0">;</span>
        <span class="br0">}</span>
<span class="br0">}</span></pre>
      </div>
    </div>
    <p>Example 2: </p>
    <div class="mw-geshi mw-code mw-content-ltr" dir="ltr">
      <div class="c source-c">
        <pre class="de1"><span class="kw1">for</span> <span class="br0">(</span>i <span class="sy0">=</span> <span class="nu0">0</span><span class="sy0">;</span> i <span class="sy0">&lt;</span> n<span class="sy0">;</span> i<span class="sy0">++</span><span class="br0">)</span>
<span class="br0">{</span>
        <span class="kw1">if</span> <span class="br0">(</span><span class="sy0">!</span>flag<span class="br0">)</span>
        <span class="br0">{</span>
           <span class="co1">//statements</span>
        <span class="br0">}</span>
        <span class="kw1">else</span>
        <span class="br0">{</span>
           <span class="kw1">if</span> <span class="br0">(</span>flag <span class="sy0">==</span> <span class="nu0">1</span><span class="br0">)</span> x<span class="br0">[</span>i<span class="br0">]</span> <span class="sy0">=</span> y<span class="br0">[</span>i<span class="br0">]</span><span class="sy0">;</span>
        <span class="br0">}</span>
<span class="br0">}</span></pre>
      </div>
    </div>
    Example 1 will have significantly better performance than Example
    2 becaues it successfully pipelines. But Example 2 can be
    pipelined if the code is modified to eliminate the nested
    "if"&nbsp;:
    <div class="csh">
      <pre style="FONT-FAMILY: monospace" class="c"><span class="kw1">for</span> <span class="br0">(</span>i <span class="sy0">=</span> <span class="nu0">0</span><span class="sy0">;</span> i <span class="sy0">&lt;</span> n<span class="sy0">;</span> i<span class="sy0">++</span><span class="br0">)</span>
<span class="br0">{</span>
        <span class="kw1">if</span> <span class="br0">(</span><span class="sy0">!</span>flag<span class="br0">)</span>
        <span class="br0">{</span>
           <span class="co1">//statements</span>
        <span class="br0">}</span>
        <span class="kw1">else</span>
        <span class="br0">{</span>
           p <span class="sy0">=</span> <span class="br0">(</span>flag <span class="sy0">==</span> <span class="nu0">1</span><span class="br0">)</span><span class="sy0">;</span>
           x<span class="br0">[</span>i<span class="br0">]</span> <span class="sy0">=</span> <span class="sy0">!</span>p <span class="sy0">*</span> x<span class="br0">[</span>i<span class="br0">]</span> <span class="sy0">+</span> p <span class="sy0">*</span> y<span class="br0">[</span>i<span class="br0">]</span> <span class="sy0">;</span>
        <span class="br0">}</span>
<span class="br0">}</span><span style="COLOR: #009900"></span></pre>
    </div>
    <p>To see other examples of how "if" statements can be modified to
      allow software pipelining, refer to <a class="extiw"
        title="tidoc:spra666" href="http://www.ti.com/lit/pdf/spra666">Hand
Tuning
        Loops and Control Code on the TMS320C6000</a>. </p>
    <p><br>
    </p>
    <h2><span id="Risks.2C_Severity" class="mw-headline">Risks, Severity
      </span></h2>
    <p>If this condition occurs, the compiler cannot perform the
      software pipelining loop optimization, which is crucial to getting
      good performance. </p>
    <p><br>
    </p>
    <h2><span id="Suggested_Action" class="mw-headline">Suggested Action
      </span></h2>
    <p>Simplify complex conditional expression/"if" statements. </p>
    <h2> <span class="mw-headline" id="More_Resources"> More Resources
      </span></h2>
    <p>Want to squeeze a few more Performance Cycles out of your
      application? Leverage the e2e (Engineer-to-Engineer) online
      community to get all of your Advice questions answered! Or, give
      back to the community with your expertise. </p>
    <p><a
        href="http://e2e.ti.com/support/development_tools/compiler/default.aspx"
        class="external text" rel="nofollow">Go to the TI Compiler's e2e
        online forum!</a>&nbsp; </p>
    <div class="hf-nsfooter">
      <table class="wikitable" style="text-align:center;
        background:White;">
        <tbody>
          <tr>
            <td><a
                href="http://processors.wiki.ti.com/index.php/File:E2e.jpg"
                class="image"><img alt="E2e.jpg"
                  src="http://processors.wiki.ti.com/images/8/82/E2e.jpg"
                  height="63" width="305"></a> </td>
            <td><i>For technical support please post your questions at <a
                  href="http://e2e.ti.com/" class="external free"
                  rel="nofollow">http://e2e.ti.com</a>. </i> </td>
          </tr>
        </tbody>
      </table>
    </div>
  </body>
</html>
